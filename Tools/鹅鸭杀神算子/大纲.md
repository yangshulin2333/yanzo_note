太棒了！就要这个执行力！🔥

这份**《鹅鸭杀 AI 军师 (GooseMind) · 开发文档 v0.1》**是专门为你定制的。

我们将项目分为三个阶段：**耳朵（听） -> 眼睛（看） -> 大脑（想）**。

我们先从**搭架子**和**数据准备**开始！

---

# 📁 项目代号：GooseMind (鹅鸭神算子)

## 1. 技术栈选型 (Tech Stack)

- **开发语言:** C# (.NET 6 或 .NET 8)
    
- **GUI 框架:** **WPF** (原因：做透明背景、异形悬浮窗比 WinForms 强太多，也不会有锯齿)
    
- **音频采集:** `NAudio` (NuGet 库)
    
- **语音转文字 (STT):** `OpenAI Whisper API` (初期为了开发速度，后期可换 `Whisper.net` 本地版)
    
- **视觉识别 (OCR):** `PaddleOCRSharp` (识别中文最强)
    
- **AI 大脑:** `DeepSeek-V3` (通过 API 调用，高性价比)
    

---

## 2. 核心数据结构 (The "Memory")

这是你之前提到的**JSON 地图数据**。我们先定义好这个“真理之书”，AI 的推理全靠它。

📂 **文件：`Maps/Basement.json` (地下室)**

_你可以直接复制这个作为你的第一个数据文件。_

JSON

```
{
  "map_name": "地下室",
  "rooms": [
    {
      "id": "laboratory",
      "name_cn": "实验室",
      "connected_to": ["upper_tunnel", "medical"],
      "tasks": [
        {"name": "调配药剂", "type": "common", "is_fakeable": false}, 
        {"name": "献祭", "type": "duck_only", "is_fakeable": true}
      ]
    },
    {
      "id": "boiler_room",
      "name_cn": "锅炉房",
      "connected_to": ["lower_tunnel", "electrical"],
      "tasks": [
        {"name": "像个男人", "type": "common", "note": "也就是搬砖任务"}
      ]
    },
    {
      "id": "fog_cave",
      "name_cn": "雾洞",
      "connected_to": ["pit"],
      "tasks": [
        {"name": "投食", "type": "goose_only", "note": "好人独有，做完会响铃"}
      ],
      "risk": "高危区域，无监控"
    }
  ],
  "common_tasks": ["钓鱼", "刷卡", "修复电线"] 
}
```

_(注：开发初期先用这几条数据跑通流程，不用一次性填完所有房间)_

---

## 3. 开发路线图 (Roadmap)

### ✅ 第一阶段：顺风耳 (MVP - 最小可行性产品)

**目标：** 一个悬浮窗，按下快捷键（如 F2），录音 5 秒，转换成文字显示在屏幕上。

- **难点：** WPF 透明窗口置顶、Global Hotkey（全局热键）。
    

### 🚧 第二阶段：千里眼 (OCR集成)

**目标：** 自动识别开局身份，每 2 秒扫描一次屏幕，看谁亮灯（谁在说话）。

- **难点：** 屏幕坐标定位、图片裁剪。
    

### 🚧 第三阶段：诸葛亮 (AI 接入)

**目标：** 将文字 + 地图数据发给 DeepSeek，返回分析结果并弹窗警告。

---

## 4. 第一步行动指南：搭建 WPF 悬浮窗

别急着写复杂的逻辑，我们今天先做**“只有壳子”的 0.1 版本**。

请打开你的 Visual Studio，按照以下步骤操作：

### Step 1: 创建项目

1. 新建项目 -> 选择 **WPF Application (.NET 6/8)**。
    
2. 命名为 `GooseMind`。
    

### Step 2: 安装 NuGet 包

在“NuGet 包管理器”中搜索并安装：

- `NAudio` (录音用)
    
- `Newtonsoft.Json` (处理上面的 JSON 用)
    
- `RestSharp` (调用 API 用，比 HttpClient 写起来简单点)
    

### Step 3: 搞定透明悬浮窗 (MainWindow.xaml)

这是最关键的 UI 代码，直接替换你的 XAML：

XML

```
<Window x:Class="GooseMind.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="GooseMind Overlay" Height="200" Width="400"
        WindowStyle="None" 
        AllowsTransparency="True" 
        Background="#80000000" 
        Topmost="True"
        Left="50" Top="50">
    
    <Grid>
        <StackPanel VerticalAlignment="Center" Margin="10">
            <TextBlock x:Name="StatusText" Text="🟢 准备就绪 (按 F2 录音)" 
                       Foreground="White" FontSize="14" FontWeight="Bold"/>
            
            <TextBlock x:Name="SubtitleText" Text="..." 
                       Foreground="#00FF00" FontSize="16" TextWrapping="Wrap" Margin="0,10,0,0"/>
            
            <Border Background="#AAFF0000" CornerRadius="5" Margin="0,10,0,0" Padding="5">
                <TextBlock x:Name="AiAdviceText" Text="⚠️ 疑点：暂无分析" Foreground="White" FontWeight="Bold"/>
            </Border>
        </StackPanel>
    </Grid>
</Window>
```

---

### 🛑 今天的作业 (Action Item)

我已经把**地图数据结构**和**UI 框架**给你了。

**你现在的任务是：**

1. 把上面的 XAML 代码复制到你的 VS 里运行一下。
    
2. 看看能不能看到一个**半透明的黑色窗口**浮在你的桌面上？
    
3. 试着把这个窗口拖到《鹅鸭杀》游戏（或者随便一个视频）上面，看看效果酷不酷？
    

**做完告诉我，如果 UI 显示没问题，我们就马上开始写 C# 后台逻辑，让它能“听懂人话”！😎**



## 第一步
我最大的失败就是 不够了解每一行代码是如何运行的，只知道个大概，以至于我没办法完全掌控开发的动向。
我先描述一下我的要求：
做一个鹅鸭杀 辅助。
分为俩个大的方面，一个是 游戏对局开始前，既可以是在游戏大厅，也可以是 组局界面，也可以是 模式选择界面。以上这些界面都属于游戏对局开始前。这个时候 可以通过本地ocr获取前置信息。比如地图是哪张，本局游戏内有哪些角色，都有内些任务，还需要记住地图，为后续正式游戏开始辅助，比如玩家在哪做了什么任务，谁谁谁在哪里死了，这些都需要辅助知道！
另一个就是匹配成功 后，点击”开始游戏“，出现”匹配成功“就会进入对局游戏内！
此时就会根据所选择的模式进入游戏，地图也会确定下来。地图一共有四张，每张地图有对应的特殊机制。角色有二十多个。还有不同的任务，有的任务是鸭子才会做的。这个时候需要开启实时辅助，此时就分为了 会议上 和会议下！会议下  由于只有“我”的视角，所以需要 辅助 记住所有重要的细节，为后续会议上发言 分析 做准备。另外如果“我”死了，辅助 为了节省 可以停止 实时辅助。直到下一局匹配游戏开始