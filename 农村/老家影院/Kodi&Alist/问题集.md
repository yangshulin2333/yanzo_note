这份 **《Kodi + AList 个人家庭影院搭建与故障排除全书》** 是基于你这两天在周口老家、使用 i7 笔记本（Linux Mint 系统）搭建影院的实战经历整理而成的。

它不仅是一份教程，更是一份**“避坑指南”**。字数详实，涵盖底层逻辑、操作步骤、配置文件详解及故障排查。

---

# 🎬 Kodi + AList 终极家庭影院搭建与调优实战指南

**适用环境**：Linux (Mint/Ubuntu) / Windows / Mac

**核心硬件**：高性能笔记本 (i7) / NAS / 电视盒子

**网络环境**：家庭宽带（含非公网环境），配合百度网盘

**目标**：打造一个海报精美、播放丝滑、永不卡顿的 4K 个人影院。

---

## 🏗️ 第一章：地基篇 —— AList 的部署与网盘挂载

Kodi 只是一个播放器，它需要一个强大的“仓库管理员”来搬运网盘里的资源。AList 就是这个管理员。在 Linux Mint 上，我们追求的是**稳定**与**低延迟**。

### 1.1 AList 的安装（Linux 终端流）

在 Linux Mint 上，最推荐使用官方的一键脚本安装，方便后续管理。

**操作步骤**：

1. 打开终端（Terminal）。
    
2. 输入安装命令：
    
    Bash
    
    ```
    curl -fsSL "https://alist.nn.ci/v3.sh" | bash -s install
    ```
    
3. **关键记录**：安装完成后，终端会吐出一段红色的信息，包含 **默认端口 (5244)** 和 **初始管理员密码**。_一定要截图保存！_
    

### 1.2 获取管理员权限

如果忘记了密码，或者想修改密码，不要重装，直接使用命令：

Bash

```
# 进入 AList 目录
cd /opt/alist
# 手动设置新密码 (例如 set 123456)
./alist admin set 123456
```

### 1.3 挂载百度网盘（核心难点）

这是整个链路的第一道关卡。挂载不好，播放就会断流。

1. **添加存储**：登录 AList 后台 (`http://localhost:5244`) -> `存储` -> `添加` -> 选择 `BaiduNetdisk`。
    
2. **获取 Token**：点击配置页面的蓝色链接，登录百度账号获取 `Refresh Token`。
	1. [百度网盘使用指南，获取Token](https://alistgo.com/zh/guide/drivers/baidu.html#%E5%88%B7%E6%96%B0%E4%BB%A4%E7%89%8C)
    
3. **关键配置（防断流第一步）**：
    
    - **WebDAV 策略**：选择 **“本地代理”**。
        
        - _原理_：让流量经过你的 i7 笔记本中转，虽然吃一点 CPU，但比“302 重定向”稳定得多，且能利用本地的缓存机制。
            
    - **开启 Web 代理**：**勾选**。
        
    - **下载接口**：选择 `official`（官方接口）。
        

### 1.4 AList 的深度调优（实战经验总结）

这是根据“播放 5 分钟卡退”和“拖进度条崩溃”得出的血泪教训。

- **自定义破解 UA**：**留空（不填）**。
    
    - _避坑_：网上很多教程让你填 `netdisk`，但在某些地区（如河南移动/联通），伪装 UA 反而会触发百度更严格的风控，导致连接被强制切断。清空后使用默认 UA 反而最稳。
        
- **自定义上传分片大小**：设置为 **`2`** (MB)。
    
    - _原理_：默认值通常较大（10MB+）。当你快进 10 秒时，如果分片太大，AList 需要下载整块数据才能响应，导致 Kodi 超时。改为 2MB 后，数据切得更碎，跳转响应极快。
        
- **上传线程**：设置为 **`1`**。
    
    - _原理_：多线程下载虽然理论速度快，但会产生高并发连接。百度网盘对并发非常敏感，线程多了容易触发“临时封禁”。单线程虽然慢点，但只要能跑满码率，它是最不掉线的。
        

---

## 🖥️ 第二章：框架篇 —— Kodi 的安装与初始化

基础打好了，现在安装播放器。Kodi 是目前地表最强的本地媒体中心。

### 2.1 安装 Kodi

在 Linux Mint 软件管理器中，或者直接终端安装：

Bash

```
sudo apt update
sudo apt install kodi
```

_推荐安装 `kodi-inputstream-adaptive` 和 `kodi-pvr-iptvsimple` 插件，为后续扩展做准备。_

### 2.2 “变砖”预防：中文设置的正确顺序

很多新手一上来就改语言，结果所有字都变成了 `□□□`（乱码）。

**正确步骤**：

1. 进入 `Settings` (齿轮) -> `Interface` -> `Skin` -> `Fonts`。
    
2. **必须先改字体**：将字体从 `Skin default` 改为 **`Arial Based`**。
    
3. 然后再去 `Regional` -> `Language` -> 改为 `Chinese (Simple)`。
    

### 2.3 连通 AList：WebDAV 协议

把 AList 挂载到 Kodi 里，让 Kodi 能看到网盘文件。

1. 进入 `文件管理` -> `添加源` -> `添加网络位置`。
    
2. **协议**：选择 **WebDAV 服务器 (HTTP)**。
    
3. **服务器地址**：`127.0.0.1`
    
4. **端口**：`5244`
    
5. **远程路径**：`dav` (注意：这里是填 dav，不是 dav/baidu)。
    
6. **用户名/密码**：你 AList 的后台账号密码。
    
7. 命名为：`AList-Local`。
    

---

## 📚 第三章：装修篇 —— 打造完美“海报墙”

这是从“看文件夹”进化到“看电影”的关键一步。

### 3.1 刮削器的选择与网络问题

Kodi 默认使用 TMDB (The Movie Database) 获取海报和简介。

- **网络障碍**：TMDB 的 API 在国内通常无法直连。
    
- **解决方案**：在 Linux Mint 上开启代理软件的 **TUN 模式**。这能让 Kodi 的流量走代理，顺利下载图片。
    

### 3.2 解决“搜不到海报”：重命名法则

Kodi 无法识别 `[2024][4K][60fps]` 这种文件名。

- **文件夹整理**：在百度网盘里，将电影放入单独文件夹，格式为 **`电影名 (年份)`**。
    
    - 例如：`异形：夺命舰 (2024)`
        
- **手动修正**：
    
    - 如果在 Kodi 里看到只有文件夹图标，按 `C` 键 -> `信息` -> `刷新`。
        
    - 在弹出的键盘里删掉乱码，手动输入电影中文名或英文名进行搜索。
        

### 3.3 建立资料库

1. 进入 `视频` -> `文件` -> `AList-Local` -> 找到存放电影的文件夹。
    
2. 长按/右键 -> `设置内容`。
    
3. **该目录包含**：选择 `电影`。
    
4. **信息提供者**：`The Movie Database Python`。
    
5. 点击确定，Kodi 开始右上角扫描。扫描完成后，主页的“电影”菜单才会被激活。
    

---

## 🎨 第四章：美化篇 —— Arctic Fuse 2 皮肤的高级配置

Arctic Fuse 2 (AF2) 是目前颜值最高的皮肤，但逻辑复杂，容易出现“哭脸”图标。

### 4.1 安装皮肤

在插件库搜索 `Arctic Fuse 2` 并安装。安装后界面会大变样，进入引导设置。

### 4.2 核心难点：Widget（小组件）挂载

很多用户（包括你）卡在这里：主页一片空白，或者显示难过的表情。这是因为皮肤不知道你要看什么。

**操作逻辑**：

1. 进入 `设置` -> `界面` -> `皮肤` -> `配置皮肤`。
    
2. 找到 **`Shortcuts`** (快捷方式) -> **`小部件`** -> **`Customise shortcuts`**。
    
3. **Hubs 配置（重点）**：
    
    - 在左侧选择 `1101 (Hub)` 或 `1102 (Hub)`。
        
    - 点击中间的 **`Add item`** (添加项目)。
        
    - **路径选择链路**：
        
        `Videos` (视频) -> `Library` (资料库) -> `Movies` (电影) -> `Recently added movies` (最近添加的电影)。
        
    - **确认挂载**：看到路径显示为 `library://video/movies/recentlyaddedmovies.xml/` 后，直接退出。
        

### 4.3 为什么会有“哭脸”？

- **原因 1**：你关联的是在线流媒体源（如 Netflix 推荐），但没有账号。
    
- **原因 2**：你关联了本地库，但 Kodi 的扫描（右上角进度条）还没结束，数据库是空的。
    
- **解决**：按照 4.2 步骤关联本地库，并等待扫描完成。
    

---

## 🚀 第五章：调优篇 —— 彻底解决卡顿、断流、快进崩溃

这是最硬核的部分，也是让你的 i7 笔记本发挥真正价值的地方。

### 5.1 问题现象分析

- **现象 A**：播放 5 分钟左右，画面静止，自动退出到菜单。
    
    - _诊断_：缓存耗尽，百度网盘连接断开，Kodi 认为文件结束。
        
- **现象 B**：拖动进度条（快进/快退），转圈很久，然后卡死或退出。
    
    - _诊断_：Kodi 请求数据过猛（Readfactor 过高），触发百度网盘限流风控。
        

### 5.2 终极解决方案：`advancedsettings.xml`

Kodi 默认只给几十 MB 缓存，根本带不动 4K 原盘。我们需要创建一个配置文件来接管 Kodi 的缓存逻辑。

**Linux 下的各种报错解决**：

很多时候 `nano` 无法保存，是因为目录不存在。

**步骤 1：强制创建配置目录**

在终端运行：

Bash

```
mkdir -p ~/.kodi/userdata/
```

**步骤 2：写入“黄金配置参数”**

不要贪心设 800MB 缓存！实测证明，**200MB 缓存 + 5倍读取** 是最稳的甜点位。

复制以下命令，在终端运行（这会直接生成文件）：

Bash

```
cat <<EOF > ~/.kodi/userdata/advancedsettings.xml
<advancedsettings>
  <cache>
    <buffermode>1</buffermode>
    <memorysize>209715200</memorysize>
    <readfactor>5</readfactor>
  </cache>
  <network>
    <curlclienttimeout>60</curlclienttimeout>
    <curllowspeedtime>60</curllowspeedtime>
    <curlretries>3</curlretries>
  </network>
</advancedsettings>
EOF
```

### 5.3 重启生效

修改完 XML 文件后，**必须重启 Kodi** 才能生效。

---

## 🛠️ 第六章：日常维护与常见问答 (FAQ)

### Q1: 为什么有时候打开电影还是卡？

**A:** 检查是否开着代理（梯子）。

- **刮削海报时**：**必须开**代理（TUN 模式）。
    
- **看电影时**：**建议关**代理。在周口农村环境下，百度网盘直连的速度往往优于经过代理转发，且代理容易干扰 AList 的本地回环（127.0.0.1）流量。
    

### Q2: 字幕怎么搞？

**A:** 推荐安装 **XBMC-Chinese** 插件库。

- 安装 `Takler` 或 `Zimuku` 字幕插件。
    
- 播放电影时 -> 确认键 -> 滚动条右侧“字幕”图标 -> `下载字幕` -> 选择匹配度高的中文外挂字幕。
    

### Q3: 磁盘空间不够了怎么办？

**A:** Kodi 的海报墙非常吃硬盘空间（主要在 `~/.kodi/userdata/Thumbnails`）。

- 定期使用 Kodi 插件库里的 **“Texture Cache Maintenance Utility”** 清理未使用的图片缓存。
    

### Q4: 如何给爷爷奶奶设置专用频道？

**A:** 利用 Arctic Fuse 2 的自定义菜单。

1. 在百度网盘建一个文件夹叫“经典老片”，放入《地道战》《长津湖》。
    
2. 在 Kodi 扫描入库。
    
3. 在 AList 中建立一个“智能播放列表”或者利用“按流派/年代”筛选。
    
4. 在皮肤设置里，把 `1103 (Hub)` 命名为“老电影”，并关联到这个列表。
    

---

## 📝 结语

从安装失败，到海报墙全是哭脸，再到播放 5 分钟断流，最后到 4K 原盘随意拖拽……你已经走完了别人可能需要折腾一个月的路。

这套系统的核心不在于软件本身，而在于**“链路平衡”**：

- **AList** 负责把百度的暴躁脾气抚平（本地代理+小分片）；
    
- **Kodi** 负责用合理的缓存策略（200MB+5倍速）去承接数据；
    
- **你** 负责坐在屏幕前，享受电影带来的震撼。
    

Enjoy your movie night! 🍿





## **AList 后台静默运行与开机自启** 

---

### 🛠️ AList 后台静默运行与开机自启笔记

### 1. 核心目标

- **隐藏窗口**：关闭终端黑框，AList 依然在后台运行。
    
- **开机自启**：电脑重启后，无需手动操作，AList 自动上线。
    
- **静默管理**：通过系统命令（Systemd）统一控制启动、停止与查看状态。
    

---

### 2. 详细配置步骤

#### 第一步：创建系统服务文件

在 Linux Mint 终端中，使用管理员权限创建一个服务配置文件：

Bash

```
sudo nano /etc/systemd/system/alist.service
```

#### 第二步：编写配置内容

将以下内容准确粘贴到编辑器中。请注意，这里假设你的 AList 安装路径为默认的 `/opt/alist`。


```
[Unit]
Description=alist
# 确保在网络就绪后再启动
After=network.target

[Service]
Type=simple
# AList 的安装目录
WorkingDirectory=/opt/alist
# 启动命令
ExecStart=/opt/alist/alist server
# 崩溃后自动重启
Restart=on-failure

[Install]
# 设定为多用户模式下自动启动
WantedBy=multi-user.target
```

> **操作提示**：粘贴完成后，按 `Ctrl + O` 然后回车保存，再按 `Ctrl + X` 退出。

#### 第三步：激活并启动服务

依次执行以下三条命令，让配置正式生效：

1. **重载系统服务配置**（让系统知道你写了新文件）：
    
    Bash
    
    ```
    sudo systemctl daemon-reload
    ```
    
2. **设置开机自启**（这是最关键的一步，成功会提示 `Created symlink...`）：
    
    Bash
    
    ```
    sudo systemctl enable alist
    ```
    
3. **立即启动服务**：
    
    Bash
    
    ```
    sudo systemctl start alist
    ```
    

---

### 3. 常用管理命令

以后你再也不需要打开那个黑框了，直接在终端输入以下命令即可管理 AList：

- **查看运行状态**（绿色 `active (running)` 代表一切正常）：
    
    Bash
    
    ```
    systemctl status alist
    ```
    
- **停止服务**：
    
    Bash
    
    ```
    sudo systemctl stop alist
    ```
    
- **重启服务**（修改 AList 存储设置后，有时重启一下更稳）：
    
    Bash
    
    ```
    sudo systemctl restart alist
    ```
    

---

### 4. 逻辑自洽说明（避坑指南）

- **为什么需要 WorkingDirectory？**
    
    如果不在配置文件里指定工作目录，AList 可能会找不到它的数据库文件（`data.db`），导致你之前配好的网盘设置丢失。
    
- **为什么会有报错？**
    
    如果执行 `enable` 时报错，通常是因为漏掉了最后两行 `[Install]` 区块的内容。
    
- **如何确认生效？**
    
    你可以试着重启电脑，**不打开终端**，直接在浏览器访问 `127.0.0.1:5244`。如果能打开，说明你已经成功把 AList 变成了系统的一部分。
    
